<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0052)https://pubweb.eng.utah.edu/~cs4400/performance.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=0.8"><title>Performance Assignment</title><link rel="stylesheet" type="text/css" href="./Performance Assignment_files/scribble.css" title="default"><link rel="stylesheet" type="text/css" href="./Performance Assignment_files/manual-style.css" title="default"><style type="text/css">
.tocset { background-color: hsl(87.5, 24%, 52.5%); }
</style><link rel="stylesheet" type="text/css" href="./Performance Assignment_files/manual-racket.css" title="default"><script type="text/javascript" src="./Performance Assignment_files/scribble-common.js"></script><script type="text/javascript" src="./Performance Assignment_files/manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">►</a></td><td></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html" class="tocviewlink" data-pltdoc="x">CS 4400 – Computer Systems &nbsp; Fall 2018</a></td></tr></tbody></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._.Schedule__subject_to_change_%29" class="tocviewlink" data-pltdoc="x">Schedule <span class="Smaller">[subject to change]</span></a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._staff%29" class="tocviewlink" data-pltdoc="x">Course Staff</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._desc%29" class="tocviewlink" data-pltdoc="x">Course Description</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._.Videos%29" class="tocviewlink" data-pltdoc="x">Videos</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._.No_.Videos%29" class="tocviewlink" data-pltdoc="x">No Videos</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._hw%29" class="tocviewselflink" data-pltdoc="x">Homework Assignments</a></td></tr></tbody></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">▼</a></td><td></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._hw%29" class="tocviewlink" data-pltdoc="x">Homework Assignments</a></td></tr></tbody></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/bomb.html" class="tocviewlink" data-pltdoc="x">Bomb Assignment</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html" class="tocviewselflink" data-pltdoc="x">Performance Assignment</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/linklab.html" class="tocviewlink" data-pltdoc="x">Linking Assignment</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/shell.html" class="tocviewlink" data-pltdoc="x">Shell Assignment</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/malloc.html" class="tocviewlink" data-pltdoc="x">Malloc Assignment</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/servlab.html" class="tocviewlink" data-pltdoc="x">Server Assignment</a></td></tr></tbody></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">►</a></td><td></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html" class="tocviewselflink" data-pltdoc="x">Performance Assignment</a></td></tr></tbody></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Image_.Representation%29" class="tocviewlink" data-pltdoc="x">Image Representation</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Pinwheel_.Operation%29" class="tocviewlink" data-pltdoc="x">Pinwheel Operation</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Glow_.Operation%29" class="tocviewlink" data-pltdoc="x">Glow Operation</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Setup%29" class="tocviewlink" data-pltdoc="x">Setup</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Data_.Structures%29" class="tocviewlink" data-pltdoc="x">Data Structures</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Pinwheel_.Implementation%29" class="tocviewlink" data-pltdoc="x">Pinwheel Implementation</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Glow%29" class="tocviewlink" data-pltdoc="x">Glow</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Performance_measures%29" class="tocviewlink" data-pltdoc="x">Performance measures</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Assumptions%29" class="tocviewlink" data-pltdoc="x">Assumptions</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Infrastructure%29" class="tocviewlink" data-pltdoc="x">Infrastructure</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Optimizing_.Pinwheel__50_points_%29" class="tocviewlink" data-pltdoc="x">Optimizing Pinwheel (50 points)</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Optimizing_.Glow__50_points_%29" class="tocviewlink" data-pltdoc="x">Optimizing Glow (50 points)</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Coding_.Rules%29" class="tocviewlink" data-pltdoc="x">Coding Rules</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._evaluation%29" class="tocviewlink" data-pltdoc="x">Evaluation</a></td></tr><tr><td align="right"></td><td><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Hand_.In_.Instructions%29" class="tocviewlink" data-pltdoc="x">Hand In Instructions</a></td></tr></tbody></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tbody><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Image_.Representation%29" class="tocsubseclink" data-pltdoc="x">Image Representation</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Pinwheel_.Operation%29" class="tocsubseclink" data-pltdoc="x">Pinwheel Operation</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Glow_.Operation%29" class="tocsubseclink" data-pltdoc="x">Glow Operation</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Setup%29" class="tocsubseclink" data-pltdoc="x">Setup</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Data_.Structures%29" class="tocsubseclink" data-pltdoc="x">Data Structures</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Pinwheel_.Implementation%29" class="tocsubseclink" data-pltdoc="x">Pinwheel Implementation</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Glow%29" class="tocsubseclink" data-pltdoc="x">Glow</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Performance_measures%29" class="tocsubseclink" data-pltdoc="x">Performance measures</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Assumptions%29" class="tocsubseclink" data-pltdoc="x">Assumptions</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Infrastructure%29" class="tocsubseclink" data-pltdoc="x">Infrastructure</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Versioning%29" class="tocsubseclink" data-pltdoc="x">Versioning</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Driver%29" class="tocsubseclink" data-pltdoc="x">Driver</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Optimizing_.Pinwheel__50_points_%29" class="tocsubseclink" data-pltdoc="x">Optimizing Pinwheel (50 points)</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Optimizing_.Glow__50_points_%29" class="tocsubseclink" data-pltdoc="x">Optimizing Glow (50 points)</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Coding_.Rules%29" class="tocsubseclink" data-pltdoc="x">Coding Rules</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._evaluation%29" class="tocsubseclink" data-pltdoc="x">Evaluation</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._.Hand_.In_.Instructions%29" class="tocsubseclink" data-pltdoc="x">Hand In Instructions</a></td></tr></tbody></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="https://pubweb.eng.utah.edu/~cs4400/bomb.html" title="backward to &quot;Bomb Assignment&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._hw%29" title="up to &quot;Homework Assignments&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="https://pubweb.eng.utah.edu/~cs4400/linklab.html" title="forward to &quot;Linking Assignment&quot;" data-pltdoc="x">next →</a></span>&nbsp;</div><h4><a name="(part._performance)"></a>Performance Assignment</h4><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>This performance assignment is based on the one by Bryant and O’Hallaron for
<span style="font-style: italic">Computer Systems: A Programmer’s Perspective</span>,
Third Edition</p></blockquote></blockquote></blockquote><p>Due: Wednesday, October 3, 11:59pm</p><p>This assignment deals with optimizing memory intensive code, and the area of
image processing offers many examples of functions that can benefit
from optimization. In this lab, we will consider two image processing
operations: <span class="stt">pinwheel</span>, which rotates a diamond-shaped portion of an image counter-clockwise by
90 degrees while also converting to grayscale, and <span class="stt">glow</span>, which blurs an
image to simulate glowing colors in a fog.</p><p>These instructions are long, but the lab itself may not be too
time-consuming to get the threshold results required for full credit. The
potential upside for clever optimizations is anyone’s guess.</p><h5><a name="(part._.Image_.Representation)"></a>Image Representation</h5><p>For this lab, we will consider an image to be represented as a size followed by a
two-dimensional matrix <span style="font-style: italic">M</span>, where <span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i,j</span></span> denotes the value of
<span style="font-style: italic"></span>(<span style="font-style: italic">i,j</span>)<span style="font-style: italic"></span>th pixel of <span style="font-style: italic">M</span>. Pixel values are triples of red, green, and
blue (RGB) values. We will only consider square images. Let <span style="font-style: italic">N</span> denote
the number of rows (or columns) of an image. Rows and columns are
numbered, in C-style, from <span style="font-style: italic"></span>0<span style="font-style: italic"></span> to <span style="font-style: italic">N-</span>1<span style="font-style: italic"></span>.</p><h5><a name="(part._.Pinwheel_.Operation)"></a>Pinwheel Operation</h5><p>Given this representation, the <span class="stt">pinwheel</span> operation applies to a
diamond-shaped center portion of the image. The diamond center is
defined as all the pixels that are completely bounded by lines drawn
from the center of one of the image to the center of an adjacent edge.
For example, in an image of size <span style="font-style: italic"></span>8<span style="font-style: italic"></span>, the diamond pixels are the
ones filled in the following image:</p><blockquote class="SCentered"><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="./Performance Assignment_files/pict_2.svg" type="image/svg+xml"></p></blockquote><p>To determine whether a pixel indexed as <span style="font-style: italic"></span>(<span style="font-style: italic">i,j</span>)<span style="font-style: italic"></span> is in the diamond
for an image of size <span style="font-style: italic">N</span>, add <span style="font-style: italic"></span>1<span style="font-style: italic">/</span>2<span style="font-style: italic"></span> to each component to
conceptually move to the center of the pixel, subtract <span style="font-style: italic">N/</span>2<span style="font-style: italic"></span> from
each component to effectively find the distance to the image’s
midpoint, then check whether the absolute values of the adjusted
components sum to less than <span style="font-style: italic">N/</span>2<span style="font-style: italic"></span>:</p><blockquote class="SCentered"><p>abs<span style="font-style: italic"></span>(<span style="font-style: italic">i+</span>1<span style="font-style: italic">/</span>2<span style="font-style: italic">-N/</span>2<span style="font-style: italic"></span>)<span style="font-style: italic"> + </span>abs<span style="font-style: italic"></span>(<span style="font-style: italic">j+</span>1<span style="font-style: italic">/</span>2<span style="font-style: italic">-N/</span>2<span style="font-style: italic"></span>)<span style="font-style: italic"> &lt; N/</span>2<span style="font-style: italic"></span></p></blockquote><p>Within the diamond portion, the following transformation applies
(using the original, unadjusted index components):</p><ul><li><p><span style="font-style: italic">Transpose</span>: For each <span style="font-style: italic"></span>(<span style="font-style: italic">i,j</span>)<span style="font-style: italic"></span> pair,
<span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i,j</span></span> and
<span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">j,i</span></span> are interchanged.</p></li><li><p><span style="font-style: italic">Exchange rows</span>: Row <span style="font-style: italic">i</span> is exchanged with row
<span style="font-style: italic">N-</span>1<span style="font-style: italic">-i</span>. Exchanging rows after transposing has the effect
of rotating an image by 90 degrees.</p></li><li><p><span style="font-style: italic">Grayscale</span>: Set the red, green, and blue components all
to the average of the three components.</p></li></ul><p>For example, applying <span class="stt">pinwheel</span> to</p><blockquote class="SCentered"><p><img src="./Performance Assignment_files/pinwheel_orig_96.png" alt="" width="96" height="96"></p></blockquote><p>produces</p><blockquote class="SCentered"><p><img src="./Performance Assignment_files/pinwheel_expected_96.png" alt="" width="96" height="96"></p></blockquote><h5><a name="(part._.Glow_.Operation)"></a>Glow Operation</h5><p>The <span class="stt">glow</span> operation is implemented by replacing every pixel
value with a combination of nine pixels: the pixels that form a 3x3
block with the target pixel in the center. Pixels in the source
image are weighted as follows:</p><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"><p>0.16</p></td><td align="right"><p>&nbsp;</p></td><td align="right"><p>0.00</p></td><td align="right"><p>&nbsp;</p></td><td align="right"><p>0.16</p></td></tr><tr><td align="right"><p>0.00</p></td><td align="right"><p>&nbsp;</p></td><td align="right"><p>0.30</p></td><td align="right"><p>&nbsp;</p></td><td align="right"><p>0.00</p></td></tr><tr><td align="right"><p>0.16</p></td><td align="right"><p>&nbsp;</p></td><td align="right"><p>0.00</p></td><td align="right"><p>&nbsp;</p></td><td align="right"><p>0.16</p></td></tr></tbody></table></blockquote><p>That is, the new value of <span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i,j</span></span>
is computed as</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i-</span>1<span style="font-style: italic">,j-</span>1<span style="font-style: italic"></span></span><span style="font-style: italic">×</span>0<span style="font-style: italic">.</span>1<span style="font-style: italic"></span>6<span style="font-style: italic"></span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">+ </span><span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i+</span>1<span style="font-style: italic">,j-</span>1<span style="font-style: italic"></span></span><span style="font-style: italic">×</span>0<span style="font-style: italic">.</span>1<span style="font-style: italic"></span>6<span style="font-style: italic"></span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">+ </span><span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i,j</span></span><span style="font-style: italic">×</span>0<span style="font-style: italic">.</span>3<span style="font-style: italic"></span>0<span style="font-style: italic"></span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">+ </span><span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i-</span>1<span style="font-style: italic">,j+</span>1<span style="font-style: italic"></span></span><span style="font-style: italic">×</span>0<span style="font-style: italic">.</span>1<span style="font-style: italic"></span>6<span style="font-style: italic"></span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">+ </span><span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i+</span>1<span style="font-style: italic">,j+</span>1<span style="font-style: italic"></span></span><span style="font-style: italic">×</span>0<span style="font-style: italic">.</span>1<span style="font-style: italic"></span>6<span style="font-style: italic"></span></p></td></tr></tbody></table><p></p><p>For the purposes of computing <span style="font-style: italic">M</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i,j</span></span>’s
value, neighbor pixels beyond the edge of the image are treated as
black.</p><p>For example, applying <span class="stt">glow</span> to</p><blockquote class="SCentered"><p><img src="./Performance Assignment_files/glow_orig_96.png" alt="" width="96" height="96"></p></blockquote><p>produces</p><blockquote class="SCentered"><p><img src="./Performance Assignment_files/glow_expected_96.png" alt="" width="96" height="96"></p></blockquote><h5><a name="(part._.Setup)"></a>Setup</h5><p>Start by copying <a href="https://pubweb.eng.utah.edu/~cs4400/perflab-handout.zip"><span class="stt">perflab-handout.zip</span></a> to a protected directory
in which you plan to do your work.  Then, run the command:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ unzip perflab-handout.zip</span></p><p>This will cause a number of files
to be unpacked into the directory.  The only file you will be
modifying and handing in is <span class="stt">"kernels.c"</span>.  The <span class="stt">"driver.c"</span>
program is a driver program that allows you to evaluate the
performance of your solutions. Use the command <span class="stt">make driver</span> to
generate the driver code and run it with the command <span class="stt">./driver</span>.</p><h5><a name="(part._.Data_.Structures)"></a>Data Structures</h5><p>The core data structure deals with image representation. A <span class="stt">pixel</span> is
a struct as shown below:</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">typedef union {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">struct {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">unsigned short red;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">/* R value */</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">unsigned short green; /* G value */</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">unsigned short blue;</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">/* B value */</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">};</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">int dim;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">} pixel;</span></p></td></tr></tbody></table><p></p><p>An image <span class="stt">I</span> is represented as a one-dimensional array of
<span class="stt">pixel</span>s. The first “pixel” in an image uses <span class="stt">dim</span> to report
the dimension of the image (i.e., the height and width, which are the
same). Each subsequent pixel uses the <span class="stt">red</span>, <span class="stt">green</span>, and
<span class="stt">blue</span> fields for one pixel’s 16-bit RGB values. The <span style="font-style: italic"></span>(<span style="font-style: italic">i,j</span>)<span style="font-style: italic"></span>th
pixel of an image <span class="stt">I</span> is <span class="stt">I[RIDX(i,j,I-&gt;dim)]</span>, where <span class="stt">RIDX</span>
is a macro defined as follows:</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">#define RIDX(i,j,n) (1+(i)*(n)+(j))</span></p></td></tr></tbody></table><p></p><p>See the file <span class="stt">"defs.h"</span> for this code.</p><p>The <span class="stt">pinwheel</span> and <span class="stt">glow</span> functions receive two <span class="stt">pixel*</span>
pointers representing source and destination images. The source image
must not be changed, and the destination image must be filled with the
result of transforming the source. The source and destination images
have the same dimensions, and the destination dimension is already
filled in when <span class="stt">pinwheel</span> or <span class="stt">rotate</span> is called.</p><h5><a name="(part._.Pinwheel_.Implementation)"></a>Pinwheel Implementation</h5><p>The following C function computes the result of pinwheeling the source
image <span class="stt">src</span> and stores the result in destination image <span class="stt">dst</span>. It
implements the diamond-inclusion test plus all three transformations (transpose, exchange, and
grayscale) in a single pass.</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">void naive_pinwheel(pixel *src, pixel *dest)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">{</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">int i, j;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">for (i = 0; i &lt; src-&gt;dim; i++)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">for (j = 0; j &lt; src-&gt;dim; j++) {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">/* Check whether we're in the diamond region */</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">if ((fabs(i + 0.5 - src-&gt;dim/2) + fabs(j + 0.5 - src-&gt;dim/2))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt; src-&gt;dim/2) {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">/* In diamond region, so rotate and grayscale */</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">int s_idx = RIDX(i, j, src-&gt;dim);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">int d_idx = RIDX(src-&gt;dim - j - 1, i, src-&gt;dim);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">dest[d_idx].red = ((int)src[s_idx].red</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">+ src[s_idx].green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">+ src[s_idx].blue) / 3;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">dest[d_idx].green = ((int)src[s_idx].red</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">+ src[s_idx].green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">+ src[s_idx].blue) / 3;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">dest[d_idx].blue = ((int)src[s_idx].red</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">+ src[s_idx].green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">+ src[s_idx].blue) / 3;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">} else {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">/* Not in diamond region, so keep the same */</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">int s_idx = RIDX(i, j, src-&gt;dim);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">int d_idx = RIDX(i, j, src-&gt;dim);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">dest[d_idx] = src[s_idx];</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></tbody></table><p></p><p>The above code scans the rows of the source image matrix, copying to
the columns of the destination image matrix.
Your task is to rewrite this code to make it run as fast as
possible using techniques like code motion and loop reorganizations.</p><p>See the file <span class="stt">"kernels.c"</span> for this code.</p><h5><a name="(part._.Glow)"></a>Glow</h5><p>The glow function takes as input a source image <span class="stt">src</span> and
returns the blurred result in the destination image <span class="stt">dst</span>.
Here is part of an implementation:</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">void naive_glow(pixel *src, pixel *dst)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">{</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">int i, j;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">for (i = 0; i &lt; src-&gt;dim; i++)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">for (j = 0; j &lt; src-&gt;dim; j++)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">dst[RIDX(i, j, src-&gt;dim)] = weighted_combo(src-&gt;dim, i, j, src);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></tbody></table><p></p><p>The function <span class="stt">weighted_combo</span> performs the weighted combination of the
pixels around the <span style="font-style: italic"></span>(<span style="font-style: italic">i,j</span>)<span style="font-style: italic"></span>th pixel. Your task is to optimize <span class="stt">glow</span> (and
<span class="stt">weighted_combo</span>) to run
as fast as possible. (<span style="font-style: italic">Note:</span> The function <span class="stt">weighted_combo</span> is a local
function and you can change it or get rid of it altogether to implement
<span class="stt">glow</span> in some other way.)</p><p>This code and an implementation of <span class="stt">weighted_combo</span> are in the
file <span class="stt">"kernels.c"</span>.</p><h5><a name="(part._.Performance_measures)"></a>Performance measures</h5><p>Our main performance measure is <span style="font-style: italic">CPE</span> or <span style="font-style: italic">Cycles per
Element</span>. If a function takes <span style="font-style: italic">C</span> cycles to run for an image of
size <span style="font-style: italic">N×N</span>, the CPE value is <span style="font-style: italic">C/N</span><span style="vertical-align: super; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span>. When you build and
<span class="stt">driver</span> its output shows CPE results for 5 different values of
<span style="font-style: italic">N</span>. The baseline measurements were made on a CADE
<span class="stt">lab1-</span><span style="font-style: italic">n</span> machine.</p><p>The ratios (speedups) of the optimized implementation over the naive
one will constitute a <span style="font-style: italic">score</span> of your implementation. To
summarize the overall effect over different values of <span style="font-style: italic">N</span>, we
will compute the <span style="font-style: italic">geometric mean</span> of the results for these 5
values. See <a href="https://pubweb.eng.utah.edu/~cs4400/performance.html#%28part._evaluation%29" data-pltdoc="x">Evaluation</a> for more information on grading.</p><h5><a name="(part._.Assumptions)"></a>Assumptions</h5><p>To make life easier, you can assume that <span style="font-style: italic">N</span> is a multiple of 32.
Your code must run correctly for all such values of <span style="font-style: italic">N</span> but we
will measure its performance only for the 5 values reported by
<span class="stt">driver</span>.</p><h5><a name="(part._.Infrastructure)"></a>Infrastructure</h5><p>We have provided support code to help you test the correctness of your
implementations and measure their performance. This section describes
how to use this infrastructure. The exact details of each part of the
assignment are described in the following section.</p><p><span style="font-style: italic">Note:</span> The only source file you will be modifying is
<span class="stt">"kernels.c"</span>.</p><h5><a name="(part._.Versioning)"></a>Versioning</h5><p>You will be writing many versions of the <span class="stt">pinwheel</span> and <span class="stt">glow</span>
routines. To help you compare the performance of all the different
versions you’ve written, we provide a way of “registering”
functions.</p><p>For example, the file <span class="stt">"kernels.c"</span> that we have provided you
contains the following function:</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">void register_pinwheel_functions() {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">add_pinwheel_function(&amp;pinwheel, pinwheel_descr);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></tbody></table><p></p><p>This function contains one or more calls to
<span class="stt">add_pinwheel_function</span>. In the above example,
<span class="stt">add_pinwheel_function</span> registers the function <span class="stt">pinwheel</span> along
with a string <span class="stt">pinwheel_descr</span> which is an ASCII description of
what the function does. See the file <span class="stt">"kernels.c"</span> to see how
to create the string descriptions. This string can be at most 256
characters long.</p><p>A similar function for your glow kernels is provided in the file
<span class="stt">driver.c</span>.</p><h5><a name="(part._.Driver)"></a>Driver</h5><p>The source code you will write will be linked with object code that we
supply into a <span class="stt">driver</span> binary. To create this binary, you will
need to execute the command</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ make driver</span></p><p>You will need to re-make driver each time you change the code in
<span class="stt">"kernels.c"</span>.</p><p>To test your implementations, you can then run the command:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ ./driver</span></p><p>The <span class="stt">driver</span> can be run in four different modes:</p><ul><li><p><span style="font-style: italic">Default mode</span>, in which all versions of your implementation are run.</p></li><li><p><span style="font-style: italic">Autograder mode</span>, in which only the <span class="stt">pinwheel</span> and
<span class="stt">glow</span> functions are run. This is the mode we will run in
when we use the driver to grade your handin.</p></li><li><p><span style="font-style: italic">File mode</span>, in which only versions that are mentioned in
an input file are run.</p></li><li><p><span style="font-style: italic">Dump mode</span>, in which a one-line description of each
version is dumped to a text file. You can then edit this text
file to keep only those versions that you’d like to test using
the <span style="font-style: italic">file mode</span>. You can specify whether to quit after
dumping the file or if your implementations are to be run.</p></li></ul><p>If run without any arguments, <span class="stt">driver</span> will run all of your
versions (<span style="font-style: italic">default mode</span>). Other modes and options can be
specified by command-line arguments to <span class="stt">driver</span>, as listed below:</p><ul><li><p><span class="stt">-g</span> —<wbr> Run only <span class="stt">pinwheel</span> and <span class="stt">glow</span> functions  (<span style="font-style: italic">autograder mode</span>).</p></li><li><p><span class="stt">-f</span> <span class="sroman">‹<span style="font-style: italic">funcfile</span>›</span> —<wbr> Execute only those versions
specified in <span class="sroman">‹<span style="font-style: italic">funcfile</span>›</span> (<span style="font-style: italic">file mode</span>).</p></li><li><p><span class="stt">-d</span> <span class="sroman">‹<span style="font-style: italic">dumpfile</span>›</span> —<wbr>- Dump the names of all versions
to a dump file called <span class="sroman">‹<span style="font-style: italic">dumpfile</span>›</span>, <span style="font-style: italic">one line</span> to
a version (<span style="font-style: italic">dump mode</span>).</p></li><li><p><span class="stt">-q</span> —<wbr> Quit after dumping version names to a dump file. To
be used in tandem with <span class="stt">-d</span>. For example, to quit immediately
after printing the dump file, type <span class="stt">./driver -qd dumpfile</span>.</p></li><li><p><span class="stt">-i</span> —<wbr> Write the main test images to files that end in
<span class="stt">".image"</span>. Each file contains <span style="font-style: italic">N</span> twice to indicate
the height and width of the image, and it contains the
pixel values as a sequence of red, green, and blue numbers.</p><p>Combined with <span class="stt">-m gradient</span> or <span class="stt">-m squares</span> and viewed
with a suitable decoder, these dumps can be helpful in debugging
problems with your functions.</p><p>One way to view a file’s image is to run</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ racket show-image.rkt </span><span class="sroman">‹<span style="font-style: italic">filename</span>›</span></p><p>on a CADE machine, or you can use</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ racket show-image.rkt --png </span><span class="sroman">‹<span style="font-style: italic">filename</span>›</span></p><p>to generate a <span class="stt">".png"</span> version.</p></li><li><p><span class="stt">-I</span> —<wbr> Write all the benchmarks images to files that end in
<span class="stt">".image"</span>.</p></li><li><p><span class="stt">-m</span> <span class="sroman">‹<span style="font-style: italic">mode</span>›</span> —<wbr> Selects the starting image, where
<span class="sroman">‹<span style="font-style: italic">mode</span>›</span> can be <span class="stt">random</span>, <span class="stt">gradient</span>, or <span class="stt">squares</span>.
The default (and grading mode) is <span class="stt">random</span>.</p></li><li><p><span class="stt">-h</span> —<wbr> Print the command line usage.</p></li></ul><h5><a name="(part._.Optimizing_.Pinwheel__50_points_)"></a>Optimizing Pinwheel (50 points)</h5><p>In this part, you will optimize <span class="stt">pinwheel</span> to achieve as low a CPE
as possible.  You should compile <span class="stt">driver</span> and then run it with the
appropriate arguments to test your implementations.</p><p>For example, running driver with the supplied naive version (for
<span class="stt">pinwheel</span>) generates the output shown below:</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ ./driver</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Pinwheel: Version = naive_pinwheel: baseline implementation:</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Dim		64	128	256	512	1024	Mean</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Your CPEs	13.2	13.3	13.1	13.2	15.2</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Baseline CPEs	13.2	13.3	13.1	13.2	15.2</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Speedup		1.0	1.0	1.0	1.0	1.0	1.0</span></p></td></tr></tbody></table><p></p><h5><a name="(part._.Optimizing_.Glow__50_points_)"></a>Optimizing Glow (50 points)</h5><p>In this part, you will optimize <span class="stt">glow</span> to achieve as low a CPE
as possible.</p><p>For example, running driver with the supplied naive version (for
<span class="stt">glow</span>) generates the output shown below:</p><p></p><table cellspacing="0" cellpadding="0"><tbody><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ ./driver</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Glow: Version = naive_glow: baseline implementation:</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Dim		32	64	128	256	512	Mean</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Your CPEs	209.9	214.3	216.9	217.9	221.0</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Baseline CPEs	212.0	217.0	219.0	220.0	221.0</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Speedup		1.0	1.0	1.0	1.0	1.0	1.0</span></p></td></tr></tbody></table><p></p><h5><a name="(part._.Coding_.Rules)"></a>Coding Rules</h5><p>You may write any code you want, as long as it satisfies the following:</p><ul><li><p>It must be in ANSI C with GNU extensions.  You may not use any embedded assembly language
statements or special <span class="stt">gcc</span> directives.</p></li><li><p>It must not interfere with the time measurement mechanism.  You may
also be penalized if your code prints any extraneous information.</p></li></ul><p>You can only modify code in <span class="stt">"kernels.c"</span>. You are allowed to
define macros, additional global variables, and other procedures in
these files.</p><h5><a name="(part._evaluation)"></a>Evaluation</h5><p>Your solutions for <span class="stt">pinwheel</span> and <span class="stt">glow</span> will each count
for 50% of your grade. The score for each will be based on the following:</p><ul><li><p>Correctness: You will get NO CREDIT for buggy code that causes
the driver to complain! This includes code that correctly operates on
the test sizes, but incorrectly on image matrices of other sizes. As
mentioned earlier, you may assume that the image dimension is a
multiple of 32.</p></li><li><p>CPE: You will get full credit for your implementations of
<span class="stt">pinwheel</span> and <span class="stt">glow</span> if they are correct and achieve mean
CPEs improvements at or above thresholds 2.5 and 4.0, respectively. In
more detail:</p><ul><li><p></p><div class="SIntrapara"><span class="stt">pinwheel</span>
</div><div class="SIntrapara"><ul><li><p>between 1.0–2.5 mean speedup: linear mapping to 0–50 points</p></li><li><p>above 2.5 mean speedup: 50 points</p></li></ul></div><p></p></li><li><p></p><div class="SIntrapara"><span class="stt">glow</span>
</div><div class="SIntrapara"><ul><li><p>between 1.0–4.0 mean speedup: linear mapping to 0–50 points</p></li><li><p>above 4.0 mean speedup: 50 points</p></li></ul></div><p></p></li></ul></li></ul><h5><a name="(part._.Hand_.In_.Instructions)"></a>Hand In Instructions</h5><p>When you have completed the lab, you will hand in one file,
<span class="stt">"kernels.c"</span>, that contains your solution. Use Canvas to
hand in your work.</p><p>Make sure that the <span class="stt">pinwheel</span> and <span class="stt">glow</span> functions correspond to
your fastest implementations, as these are the only functions that
will be tested when we use the driver to grade your assignment.</p><p>Remember also to remove any extraneous print statements.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="https://pubweb.eng.utah.edu/~cs4400/bomb.html" title="backward to &quot;Bomb Assignment&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="https://pubweb.eng.utah.edu/~cs4400/index.html#%28part._hw%29" title="up to &quot;Homework Assignments&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="https://pubweb.eng.utah.edu/~cs4400/linklab.html" title="forward to &quot;Linking Assignment&quot;" data-pltdoc="x">next →</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>